/* Blockly Custom Styling - Micro:bit Theme */

/* Ensure disabled Blockly blocks visibly fade even across custom themes */
.blocklyDisabled path.blocklyBlockBackground,
.blocklyDisabled .blocklyPath,
.blocklyDisabled {
  opacity: 0.45 !important;
}

/* Blockly toolbox category styling - modern look */
.blocklyTreeRow {
  padding: 10px 16px !important;
  margin: 2px 0 !important;
  border-radius: 0 !important;
  transition: all 0.15s ease !important;
  border-left: 4px solid transparent !important;
  min-height: 48px !important;
  display: flex !important;
  align-items: center !important;
}

.blocklyTreeRow:hover {
  background-color: rgba(0, 0, 0, 0.05) !important;
  border-left-color: currentColor !important;
}

.blocklyTreeRow.blocklyTreeSelected {
  background-color: rgba(0, 0, 0, 0.08) !important;
  border-left-color: currentColor !important;
}

.blocklyTreeLabel {
  font-size: 16px !important;
  font-weight: 500 !important;
  letter-spacing: 0.2px !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
}

/* Icon styling for categories - using CSS pseudo-elements with SVG backgrounds */
.blocklyTreeRow .blocklyTreeLabel::before {
  content: "";
  display: inline-block;
  width: 24px;
  height: 24px;
  margin-right: 12px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  vertical-align: middle;
  flex-shrink: 0;
}

/* Basic icon - grid/app icon */
.blocklyTreeRow[style*="color: rgb(0, 120, 215)"] .blocklyTreeLabel::before,
.blockly-basic-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%230078D7'%3E%3Cpath d='M4 4h7v7H4V4m0 9h7v7H4v-7m9-9h7v7h-7V4m0 9h7v7h-7v-7z'/%3E%3C/svg%3E");
}

/* Input icon - game controller */
.blocklyTreeRow[style*="color: rgb(199, 36, 177)"] .blocklyTreeLabel::before,
.blockly-input-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23C724B1'%3E%3Cpath d='M7 6h10l-5.01 6.3L7 6zm-1.99 4.99L2 10l5.01 1 .99 3-3.01-.01zm11.98.01l-1-.01-1 3 5.01 1-3.01-4.01zm2-2.99L18 11l-5.01-1L12 7l7.01 3zM12 15c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z'/%3E%3C/svg%3E");
}

/* Music icon - musical note */
.blocklyTreeRow[style*="color: rgb(235, 68, 55)"] .blocklyTreeLabel::before,
.blockly-music-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23EB4437'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E");
}

/* Led icon - lightbulb */
.blocklyTreeRow[style*="color: rgb(106, 27, 154)"] .blocklyTreeLabel::before,
.blockly-led-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%236A1B9A'%3E%3Cpath d='M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 0 1 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z'/%3E%3C/svg%3E");
}

/* Radio icon - broadcast/signal */
.blocklyTreeRow[style*="color: rgb(233, 30, 99)"] .blocklyTreeLabel::before,
.blockly-radio-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23E91E63'%3E%3Cpath d='M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z'/%3E%3C/svg%3E");
}

/* Loops icon - refresh/repeat */
.blocklyTreeRow[style*="color: rgb(55, 171, 65)"] .blocklyTreeLabel::before,
.blockly-loops-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2337AB41'%3E%3Cpath d='M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46A7.93 7.93 0 0 0 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74A7.93 7.93 0 0 0 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z'/%3E%3C/svg%3E");
}

/* Logic icon - git branch/decision tree */
.blocklyTreeRow[style*="color: rgb(0, 188, 212)"] .blocklyTreeLabel::before,
.blockly-logic-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300BCD4'%3E%3Cpath d='M6 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 2.8-2H11v5h2V6h2.2a3 3 0 0 0 2.8 2 3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-2.8 2H13v2h-2V4H8.8A3 3 0 0 0 6 2m0 2a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m12 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-6 7a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 2a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1z'/%3E%3C/svg%3E");
}

/* Variables icon - list/document */
.blocklyTreeRow[style*="color: rgb(220, 53, 69)"] .blocklyTreeLabel::before,
.blockly-variables-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23DC3545'%3E%3Cpath d='M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m7 1.5V9h5.5L13 3.5zM8 11v2h8v-2H8m0 4v2h8v-2H8z'/%3E%3C/svg%3E");
}

/* Math icon - calculator */
.blocklyTreeRow[style*="color: rgb(123, 45, 143)"] .blocklyTreeLabel::before,
.blockly-math-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%237B2D8F'%3E%3Cpath d='M7 2h10a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 2v4h10V4H7m0 6v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2m-8 4v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2m-8 4v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2z'/%3E%3C/svg%3E");
}

/* Advanced icon - settings/gear */
.blocklyTreeRow[style*="color: rgb(92, 92, 92)"] .blocklyTreeLabel::before,
.blockly-advanced-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%235C5C5C'%3E%3Cpath d='M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z'/%3E%3C/svg%3E");
}

/* Toolbox container styling */
.blocklyToolboxDiv {
  background-color: #f3f3f3 !important;
  border-right: 1px solid #ddd !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
}

/* Search box styling */
.blocklySearchBox {
  padding: 12px !important;
  background: white !important;
  border-bottom: 1px solid #ddd !important;
}

.blocklySearchBox input {
  width: 100% !important;
  padding: 8px 12px !important;
  border: 1px solid #ccc !important;
  border-radius: 4px !important;
  font-size: 14px !important;
}

/* Blockly flyout (block preview area) styling */
.blocklyFlyout {
  border-radius: 12px 0 0 12px !important;
  box-shadow: -2px 0 12px rgba(0, 0, 0, 0.1) !important;
  background: #f9f9f9 !important;
}

.blocklyFlyoutBackground {
  fill: #f9f9f9 !important;
  fill-opacity: 1 !important;
}

/* Add visual separation between block groups in flyout */
.blocklyFlyout .blocklyBlockCanvas > g[transform] + g[transform] {
  margin-top: 8px;
}

/* Enhance blocks in flyout with better spacing */
.blocklyFlyout .blocklyDraggable {
  margin: 6px 0 !important;
}

/* Add labels/headers for block categories in flyout */
.blocklyFlyoutLabel {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
  font-size: 14px !important;
  font-weight: 600 !important;
  fill: #666 !important;
}

/* Style the flyout scrollbar */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #ccc !important;
  rx: 4 !important;
}

.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #999 !important;
}

.blocklyFlyout .blocklyScrollbarBackground {
  fill: #f3f3f3 !important;
  stroke: none !important;
}

/* Add icon decoration to specific blocks in flyout */
/* This uses data attributes that can be added to blocks */
[data-block-icon]::before {
  content: attr(data-block-icon);
  display: inline-block;
  margin-right: 8px;
  font-size: 18px;
}

/* Enhanced visual hierarchy in flyout */
.blocklyFlyout .blocklyBlockCanvas {
  padding: 12px 8px !important;
}

/* Add subtle hover effect on blocks in flyout */
.blocklyFlyout .blocklyDraggable:hover {
  transform: translateX(-2px);
  transition: transform 0.15s ease;
}

/* Style buttons in flyout (like "Make a Variable") */
.blocklyFlyout .blocklyFlyoutButton {
  fill: #fff !important;
  stroke: #ddd !important;
  stroke-width: 1px !important;
  rx: 6 !important;
  ry: 6 !important;
}

.blocklyFlyout .blocklyFlyoutButton:hover {
  fill: #f0f0f0 !important;
  stroke: #0078D7 !important;
  stroke-width: 2px !important;
}

.blocklyFlyout .blocklyFlyoutButtonBackground {
  fill: #fff !important;
  stroke: #ddd !important;
}

.blocklyFlyout .blocklyText.blocklyFlyoutLabelText {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
  font-weight: 500 !important;
  fill: #333 !important;
}

/* Improve block field styling */
.blocklyEditableText {
  fill: #333 !important;
  font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace !important;
}

.blocklyEditableText rect {
  fill: rgba(255, 255, 255, 0.3) !important;
  stroke: rgba(0, 0, 0, 0.1) !important;
}

/* Dropdown fields styling */
.blocklyDropDownDiv {
  border-radius: 8px !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
  border: 1px solid #ddd !important;
  background-color: white !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
}

.blocklyDropDownDiv .goog-menuitem {
  padding: 8px 16px !important;
  font-size: 14px !important;
}

.blocklyDropDownDiv .goog-menuitem-highlight {
  background-color: #e3f2fd !important;
  color: #0078D7 !important;
}

/* Input fields in blocks */
.blocklyHtmlInput {
  font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace !important;
  border: 1px solid #ddd !important;
  border-radius: 4px !important;
  padding: 4px 8px !important;
  background: rgba(255, 255, 255, 0.9) !important;
}

/* Context menu styling */
.blocklyContextMenu {
  border-radius: 8px !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
  border: 1px solid #ddd !important;
}

.blocklyMenuItem {
  padding: 8px 16px !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
  font-size: 14px !important;
}

.blocklyMenuItemHighlight {
  background-color: #e3f2fd !important;
}

.blocklyMenuItemContent {
  color: #333 !important;
}


/* Blockly workspace background */
.blocklyMainBackground {
  stroke: none !important;
  fill: #f8f9fa !important;
}

/* Smoother block shadows */
.blocklyBlockCanvas .blocklyDraggable {
  filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.15));
}

.blocklyBlockCanvas .blocklyDraggable:hover {
  filter: drop-shadow(0 4px 10px rgba(0, 0, 0, 0.22));
  transition: filter 0.2s ease;
}

/* blockly fix */
svg[display="none"] {
  display: none;
}

/* Category-specific flyout header styling with icons */
.blocklyFlyout .blocklyFlyoutLabelText {
  font-size: 16px !important;
  font-weight: 600 !important;
  fill: #333 !important;
}

/* Add visual indicators for block types */
/* Basic blocks - show grid icon */
.blocklyFlyout g[data-category="Basic"] .blocklyPath,
g.blocklyDraggable[data-id*="show_string"] .blocklyPath,
g.blocklyDraggable[data-id*="show_number"] .blocklyPath,
g.blocklyDraggable[data-id*="on_start"] .blocklyPath {
  filter: brightness(1.05);
}

/* Input blocks - add subtle glow */
g.blocklyDraggable[data-id*="button"] .blocklyPath,
g.blocklyDraggable[data-id*="input"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(199, 36, 177, 0.3));
}

/* LED blocks - add glow effect */
g.blocklyDraggable[data-id*="led"] .blocklyPath,
g.blocklyDraggable[data-id*="plot"] .blocklyPath,
g.blocklyDraggable[data-id*="show_leds"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(106, 27, 154, 0.3));
}

/* Loop blocks - add rotation hint */
g.blocklyDraggable[data-id*="forever"] .blocklyPath,
g.blocklyDraggable[data-id*="while"] .blocklyPath,
g.blocklyDraggable[data-id*="for"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(55, 171, 65, 0.3));
}

/* Logic blocks - add branch indicator */
g.blocklyDraggable[data-id*="if"] .blocklyPath,
g.blocklyDraggable[data-id*="logic"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(0, 188, 212, 0.3));
}

/* Enhanced block spacing in flyout */
.blocklyFlyout .blocklyBlockCanvas > g {
  margin-bottom: 8px;
}

/* Add separator lines between block groups */
.blocklyFlyout .blocklyFlyoutButton + g,
.blocklyFlyout text.blocklyText[text-anchor="start"] + g {
  margin-top: 16px !important;
}

/* Better visual feedback for dragging from flyout */
.blocklyDragging {
  opacity: 0.8 !important;
  filter: drop-shadow(0 6px 20px rgba(0, 0, 0, 0.3)) !important;
}

/* Improve block corner radius */
.blocklyPath {
  stroke-width: 1px !important;
  stroke-opacity: 0.2 !important;
}

/* Add subtle animation to blocks on hover in workspace */
.blocklyWorkspace .blocklyDraggable:hover .blocklyPath {
  filter: brightness(1.1) drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
  transition: filter 0.2s ease;
}

/* Improve connection highlights */
.blocklyConnectionCircle {
  fill: #fff !important;
  stroke: currentColor !important;
  stroke-width: 2px !important;
}

.blocklyReplaceable .blocklyPath {
  stroke: #ffa500 !important;
  stroke-width: 3px !important;
  fill-opacity: 0.9 !important;
}

/* Enhanced insertion marker */
.blocklyInsertionMarker .blocklyPath {
  fill-opacity: 0.3 !important;
  stroke: #333 !important;
  stroke-width: 2px !important;
  stroke-dasharray: 4, 4 !important;
}

/* Improve trash can styling */
.blocklyTrash {
  opacity: 0.8;
  transition: opacity 0.2s;
}

.blocklyTrash:hover {
  opacity: 1;
}

/* Better zoom controls */
.blocklyZoom {
  opacity: 0.7;
  transition: opacity 0.2s;
}

.blocklyZoom:hover {
  opacity: 1;
}

.blocklyZoom > image {
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}
