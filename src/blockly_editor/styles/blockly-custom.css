/* Make copied blocks appear darker */

/* Blockly Custom Styling - Modern Micro:bit Theme with Glassmorphism */

/* ULTRA AGGRESSIVE CATEGORY STYLING - MAXIMUM PRIORITY */
.blocklyTreeRow,
div.blocklyTreeRow,
.blocklyToolboxDiv .blocklyTreeRow,
[class*="blocklyTreeRow"] {
  padding: 20px 24px 20px 20px !important;
  margin: 12px 18px !important;
  border-radius: 24px !important;
  border: 3px solid rgba(0, 120, 215, 0.1) !important;
  border-left: 6px solid transparent !important;
  min-height: 72px !important;
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.98) 0%, 
    rgba(248, 252, 255, 0.95) 50%, 
    rgba(242, 248, 254, 0.98) 100%) !important;
  box-shadow: 
    0 6px 16px rgba(0, 0, 0, 0.08),
    0 3px 8px rgba(0, 0, 0, 0.04),
    inset 0 2px 0 rgba(255, 255, 255, 0.9) !important;
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
  position: relative !important;
  overflow: visible !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
}

.blocklyTreeRow:hover,
div.blocklyTreeRow:hover,
.blocklyToolboxDiv .blocklyTreeRow:hover {
  background: linear-gradient(135deg, 
    rgba(230, 242, 255, 1) 0%, 
    rgba(220, 237, 255, 0.98) 50%, 
    rgba(210, 232, 255, 1) 100%) !important;
  border-left-color: #0078D7 !important;
  border-left-width: 8px !important;
  border-color: rgba(0, 120, 215, 0.3) !important;
  box-shadow: 
    0 16px 40px rgba(0, 120, 215, 0.25),
    0 8px 20px rgba(0, 120, 215, 0.15),
    0 4px 12px rgba(0, 0, 0, 0.1),
    inset 0 3px 0 rgba(255, 255, 255, 1) !important;
  transform: translateX(10px) scale(1.04) !important;
  z-index: 100 !important;
}

.blocklyTreeRow.blocklyTreeSelected,
div.blocklyTreeRow.blocklyTreeSelected,
.blocklyToolboxDiv .blocklyTreeRow.blocklyTreeSelected {
  background: linear-gradient(135deg, 
    rgba(0, 120, 215, 0.2) 0%, 
    rgba(0, 150, 230, 0.15) 50%, 
    rgba(0, 120, 215, 0.12) 100%) !important;
  border-left-color: #0078D7 !important;
  border-left-width: 10px !important;
  border-color: rgba(0, 120, 215, 0.5) !important;
  box-shadow: 
    0 20px 48px rgba(0, 120, 215, 0.3),
    0 10px 24px rgba(0, 120, 215, 0.2),
    0 5px 14px rgba(0, 0, 0, 0.12),
    inset 0 3px 0 rgba(255, 255, 255, 0.8),
    inset 0 0 80px rgba(0, 120, 215, 0.1) !important;
  transform: translateX(12px) scale(1.05) !important;
  z-index: 200 !important;
}

.blocklyTreeLabel,
.blocklyTreeRow .blocklyTreeLabel,
div.blocklyTreeRow .blocklyTreeLabel {
  font-size: 16.5px !important;
  font-weight: 700 !important;
  letter-spacing: 0.4px !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "SF Pro Display", system-ui, Roboto, sans-serif !important;
  color: #1a202c !important;
  text-shadow: 0 1px 2px rgba(255,255,255,0.9) !important;
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
}

.blocklyTreeRow:hover .blocklyTreeLabel,
div.blocklyTreeRow:hover .blocklyTreeLabel {
  color: #0066cc !important;
  letter-spacing: 0.6px !important;
  font-weight: 800 !important;
  text-shadow: 0 2px 8px rgba(0, 120, 215, 0.25) !important;
}

.blocklyTreeRow.blocklyTreeSelected .blocklyTreeLabel,
div.blocklyTreeRow.blocklyTreeSelected .blocklyTreeLabel {
  color: #0052a3 !important;
  letter-spacing: 0.7px !important;
  font-weight: 900 !important;
  text-shadow: 0 3px 12px rgba(0, 120, 215, 0.35) !important;
}

.blocklyToolboxDiv,
div.blocklyToolboxDiv {
  background: linear-gradient(180deg, 
    rgba(255, 255, 255, 0.98) 0%, 
    rgba(250, 252, 255, 0.95) 50%,
    rgba(245, 250, 255, 0.98) 100%) !important;
  border-right: 3px solid rgba(0, 120, 215, 0.15) !important;
  box-shadow: 
    6px 0 28px rgba(0, 0, 0, 0.08),
    12px 0 56px rgba(0, 0, 0, 0.04) !important;
}

.blocklyTreeRoot,
.blocklyToolboxDiv .blocklyTreeRoot {
  padding: 24px 0 !important;
}

/* Ensure disabled Blockly blocks visibly fade even across custom themes */
.blocklyDisabled path.blocklyBlockBackground,
.blocklyDisabled .blocklyPath,
.blocklyDisabled {
  opacity: 0.5 !important;
  filter: grayscale(0.8) saturate(0.3) !important;
  transition: all 0.3s ease !important;
  pointer-events: none !important;
}

/* Add diagonal stripe pattern for disabled blocks like MakeCode */
.blocklyDisabledPattern {
  opacity: 0.5 !important;
}

.blocklyDisabledPattern .blocklyPath {
  /* fill-opacity: 0.5 !important; */
  stroke-opacity: 0.6 !important;
  filter: grayscale(1) !important;
}

/* Ensure child blocks also appear disabled */
.blocklyDisabled .blocklyBlock,
.blocklyDisabledPattern .blocklyBlock {
  opacity: 0.5 !important;
  filter: grayscale(0.8) !important;
}

/* Blockly toolbox category styling - Ultra-modern card design with premium aesthetics */

.blocklyTreeRow,
.blocklyToolboxCategory {
  padding: 18px 20px 18px 16px !important;
  margin: 10px 16px !important;
  border-radius: 20px !important;
  transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
  border: 2px solid transparent !important;
  border-left: 5px solid transparent !important;
  min-height: 68px !important;
  display: flex !important;
  align-items: center !important;
  backdrop-filter: blur(20px) saturate(180%) !important;
  -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
  cursor: pointer !important;
  position: relative !important;
  box-shadow: 
    0 4px 12px rgba(0, 0, 0, 0.08),
    0 2px 6px rgba(0, 0, 0, 0.04),
    inset 0 1px 0 rgba(255, 255, 255, 0.8) !important;
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.98) 0%, 
    rgba(250, 252, 255, 0.95) 50%, 
    rgba(245, 248, 252, 0.98) 100%) !important;
  outline: none !important;
  overflow: hidden !important;
  transform-origin: left center !important;
}

.blocklyTreeRow::before {
  content: "" !important;
  position: absolute !important;
  inset: -2px !important;
  border-radius: 20px !important;
  background: linear-gradient(135deg, 
    rgba(0, 120, 215, 0.1) 0%, 
    rgba(0, 188, 212, 0.08) 25%,
    rgba(106, 27, 154, 0.06) 50%,
    rgba(199, 36, 177, 0.08) 75%,
    rgba(0, 120, 215, 0.1) 100%) !important;
  background-size: 200% 200% !important;
  animation: gradientShift 8s ease infinite !important;
  opacity: 0 !important;
  transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
  pointer-events: none !important;
  z-index: 0 !important;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.blocklyTreeRow::after {
  content: "→" !important;
  position: absolute !important;
  right: 20px !important;
  top: 50% !important;
  transform: translateY(-50%) translateX(10px) !important;
  font-size: 20px !important;
  font-weight: 700 !important;
  color: rgba(0, 120, 215, 0) !important;
  opacity: 0 !important;
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
  pointer-events: none !important;
  z-index: 2 !important;
}


.blocklyTreeRow:hover,
.blocklyTreeRow:focus-visible,
.blocklyToolboxCategory:hover,
.blocklyToolboxCategory:focus-visible {
  background: linear-gradient(135deg, 
    rgba(235, 245, 255, 1) 0%, 
    rgba(225, 240, 255, 0.98) 50%, 
    rgba(215, 235, 255, 1) 100%) !important;
  border-color: rgba(0, 120, 215, 0.3) !important;
  border-left-color: #0078D7 !important;
  border-left-width: 6px !important;
  box-shadow: 
    0 12px 32px rgba(0, 120, 215, 0.2),
    0 6px 16px rgba(0, 120, 215, 0.12),
    0 2px 8px rgba(0, 0, 0, 0.08),
    inset 0 2px 0 rgba(255, 255, 255, 0.9) !important;
  transform: translateX(8px) scale(1.03) !important;
  outline: none !important;
  z-index: 10 !important;
}

.blocklyTreeRow:hover::before,
.blocklyToolboxCategory:hover::before {
  opacity: 1 !important;
}

.blocklyTreeRow:hover::after,
.blocklyToolboxCategory:hover::after {
  color: rgba(0, 120, 215, 1) !important;
  opacity: 1 !important;
  transform: translateY(-50%) translateX(0px) !important;
}

.blocklyTreeRow:active,
.blocklyToolboxCategory:active {
  transform: translateX(6px) scale(1.01) !important;
  transition: all 0.1s ease !important;
}


.blocklyTreeRow.blocklyTreeSelected,
.blocklyToolboxCategory.blocklyTreeSelected {
  background: linear-gradient(135deg, 
    rgba(0, 120, 215, 0.18) 0%, 
    rgba(0, 150, 230, 0.12) 50%, 
    rgba(0, 120, 215, 0.1) 100%) !important;
  border-color: rgba(0, 120, 215, 0.4) !important;
  border-left-color: #0078D7 !important;
  border-left-width: 7px !important;
  box-shadow: 
    0 14px 40px rgba(0, 120, 215, 0.25),
    0 8px 20px rgba(0, 120, 215, 0.15),
    0 4px 12px rgba(0, 0, 0, 0.1),
    inset 0 2px 0 rgba(255, 255, 255, 0.6),
    inset 0 0 60px rgba(0, 120, 215, 0.08) !important;
  transform: translateX(10px) scale(1.04) !important;
  outline: none !important;
  z-index: 15 !important;
  animation: pulseGlow 2s ease-in-out infinite !important;
}

@keyframes pulseGlow {
  0%, 100% {
    box-shadow: 
      0 14px 40px rgba(0, 120, 215, 0.25),
      0 8px 20px rgba(0, 120, 215, 0.15),
      0 4px 12px rgba(0, 0, 0, 0.1),
      inset 0 2px 0 rgba(255, 255, 255, 0.6),
      inset 0 0 60px rgba(0, 120, 215, 0.08);
  }
  50% {
    box-shadow: 
      0 16px 44px rgba(0, 120, 215, 0.3),
      0 10px 24px rgba(0, 120, 215, 0.18),
      0 6px 14px rgba(0, 0, 0, 0.12),
      inset 0 2px 0 rgba(255, 255, 255, 0.7),
      inset 0 0 80px rgba(0, 120, 215, 0.12);
  }
}

.blocklyTreeRow.blocklyTreeSelected::before,
.blocklyToolboxCategory.blocklyTreeSelected::before {
  opacity: 1 !important;
  animation: gradientShift 6s ease infinite !important;
}

.blocklyTreeRow.blocklyTreeSelected::after,
.blocklyToolboxCategory.blocklyTreeSelected::after {
  color: rgba(0, 120, 215, 1) !important;
  opacity: 1 !important;
  transform: translateY(-50%) translateX(-2px) !important;
  font-size: 22px !important;
  text-shadow: 0 2px 8px rgba(0, 120, 215, 0.4) !important;
}


.blocklyTreeLabel {
  font-size: 15.5px !important;
  font-weight: 600 !important;
  letter-spacing: 0.3px !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "SF Pro Display", Roboto, sans-serif !important;
  color: #2d3748 !important;
  flex: 1 1 auto !important;
  user-select: none !important;
  text-shadow: 0 1px 3px rgba(255,255,255,0.9) !important;
  transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
  position: relative !important;
  z-index: 2 !important;
  line-height: 1.4 !important;
}

.blocklyTreeRow:hover .blocklyTreeLabel {
  color: #0078D7 !important;
  letter-spacing: 0.5px !important;
  font-weight: 700 !important;
  text-shadow: 0 2px 4px rgba(0, 120, 215, 0.15) !important;
  transform: translateX(2px) !important;
}

.blocklyTreeRow.blocklyTreeSelected .blocklyTreeLabel {
  color: #0066cc !important;
  letter-spacing: 0.6px !important;
  font-weight: 700 !important;
  text-shadow: 0 2px 6px rgba(0, 120, 215, 0.2) !important;
  transform: translateX(3px) !important;
}

/* Icon styling for categories - Premium animated icons */

.blocklyTreeRow .blocklyTreeLabel::before {
  content: "";
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 38px;
  height: 38px;
  margin-right: 14px;
  margin-left: 2px;
  background-size: 24px 24px;
  background-repeat: no-repeat;
  background-position: center;
  border-radius: 12px;
  background-color: rgba(255, 255, 255, 0.6);
  flex-shrink: 0;
  filter: drop-shadow(0 2px 6px rgba(0,0,0,0.08));
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  transform: scale(1) rotate(0deg);
  border: 2px solid rgba(0, 120, 215, 0.08);
  position: relative;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.8), 0 2px 8px rgba(0,0,0,0.06);
}

.blocklyTreeRow:hover .blocklyTreeLabel::before {
  filter: drop-shadow(0 4px 12px rgba(0, 120, 215, 0.25)) brightness(1.15);
  transform: scale(1.15) rotate(-8deg);
  background-color: rgba(235, 245, 255, 0.9);
  border-color: rgba(0, 120, 215, 0.3);
  box-shadow: 
    inset 0 2px 0 rgba(255,255,255,0.9),
    0 4px 16px rgba(0, 120, 215, 0.2),
    0 0 20px rgba(0, 120, 215, 0.1);
}

.blocklyTreeRow.blocklyTreeSelected .blocklyTreeLabel::before {
  filter: drop-shadow(0 6px 16px rgba(0, 120, 215, 0.3)) brightness(1.2);
  transform: scale(1.2) rotate(-12deg);
  background-color: rgba(220, 240, 255, 1);
  border-color: rgba(0, 120, 215, 0.5);
  border-width: 3px;
  box-shadow: 
    inset 0 2px 0 rgba(255,255,255,1),
    0 6px 20px rgba(0, 120, 215, 0.3),
    0 0 30px rgba(0, 120, 215, 0.15);
  animation: iconPulse 2s ease-in-out infinite;
}

@keyframes iconPulse {
  0%, 100% { transform: scale(1.2) rotate(-12deg); }
  50% { transform: scale(1.25) rotate(-10deg); }
}
/* Accessibility: focus-visible for keyboard navigation */
.blocklyTreeRow:focus-visible {
  outline: 2.5px solid #0078D7 !important;
  outline-offset: 0px !important;
  z-index: 4;
}

/* Ultra-modern separator with animated gradient and glow */
.blocklyTreeSeparator,
.blocklyToolboxDiv .blocklyTreeSeparator {
  height: 1px !important;
  margin: 24px 24px !important;
  background: linear-gradient(90deg, 
    transparent 0%, 
    rgba(0, 120, 215, 0.1) 15%,
    rgba(0, 188, 212, 0.3) 35%, 
    rgba(106, 27, 154, 0.4) 50%, 
    rgba(199, 36, 177, 0.3) 65%,
    rgba(0, 120, 215, 0.1) 85%,
    transparent 100%) !important;
  background-size: 200% 100%;
  animation: separatorFlow 6s ease infinite;
  border: none !important;
  position: relative !important;
  overflow: visible !important;
  box-shadow: 0 0 8px rgba(0, 120, 215, 0.15);
}

@keyframes separatorFlow {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.blocklyTreeSeparator::before {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: linear-gradient(135deg, 
    rgba(0, 120, 215, 0.15) 0%, 
    rgba(0, 188, 212, 0.12) 50%,
    rgba(106, 27, 154, 0.15) 100%);
  box-shadow: 
    0 0 16px rgba(0, 120, 215, 0.3),
    inset 0 2px 4px rgba(255, 255, 255, 0.5);
  border: 2px solid rgba(255, 255, 255, 0.8);
  animation: separatorDotPulse 3s ease-in-out infinite;
}

@keyframes separatorDotPulse {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.6;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.15);
    opacity: 0.9;
  }
}

.blocklyTreeSeparator::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: linear-gradient(135deg, #0078D7, #00BCD4);
  box-shadow: 
    0 0 12px rgba(0, 120, 215, 0.6),
    0 0 24px rgba(0, 120, 215, 0.3);
  animation: separatorCenterGlow 2s ease-in-out infinite;
}

@keyframes separatorCenterGlow {
  0%, 100% {
    box-shadow: 
      0 0 12px rgba(0, 120, 215, 0.6),
      0 0 24px rgba(0, 120, 215, 0.3);
  }
  50% {
    box-shadow: 
      0 0 20px rgba(0, 120, 215, 0.8),
      0 0 36px rgba(0, 120, 215, 0.5);
  }
}

/* Subtle divider between categories for clarity */
.blocklyTreeRow:not(:last-child) {
  margin-bottom: 6px !important;
}

/* Stunning entry animation for categories */
@keyframes categoryFadeIn {
  from {
    opacity: 0;
    transform: translateX(-40px) scale(0.9);
    filter: blur(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0) scale(1);
    filter: blur(0);
  }
}

.blocklyTreeRow {
  animation: categoryFadeIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
}

.blocklyTreeRow:nth-child(1) { animation-delay: 0.05s; }
.blocklyTreeRow:nth-child(2) { animation-delay: 0.1s; }
.blocklyTreeRow:nth-child(3) { animation-delay: 0.15s; }
.blocklyTreeRow:nth-child(4) { animation-delay: 0.2s; }
.blocklyTreeRow:nth-child(5) { animation-delay: 0.25s; }
.blocklyTreeRow:nth-child(6) { animation-delay: 0.3s; }
.blocklyTreeRow:nth-child(7) { animation-delay: 0.35s; }
.blocklyTreeRow:nth-child(8) { animation-delay: 0.4s; }
.blocklyTreeRow:nth-child(9) { animation-delay: 0.45s; }
.blocklyTreeRow:nth-child(10) { animation-delay: 0.5s; }

/* Premium badge indicators with animated glow */
.blocklyTreeRow .blocklyTreeLabel::after {
  content: "";
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: linear-gradient(135deg, rgba(0, 120, 215, 0.4), rgba(0, 188, 212, 0.3));
  margin-left: auto;
  margin-right: 8px;
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 0 0 0 rgba(0, 120, 215, 0.4);
  animation: badgePulse 3s ease-in-out infinite;
}

@keyframes badgePulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(0, 120, 215, 0.4);
  }
  50% {
    box-shadow: 0 0 0 4px rgba(0, 120, 215, 0.1);
  }
}

.blocklyTreeRow:hover .blocklyTreeLabel::after {
  background: linear-gradient(135deg, rgba(0, 120, 215, 0.9), rgba(0, 188, 212, 0.7));
  box-shadow: 
    0 0 12px rgba(0, 120, 215, 0.6),
    0 0 24px rgba(0, 120, 215, 0.3);
  transform: scale(1.4);
  animation: none;
}

.blocklyTreeRow.blocklyTreeSelected .blocklyTreeLabel::after {
  background: linear-gradient(135deg, rgba(0, 120, 215, 1), rgba(0, 188, 212, 0.9));
  box-shadow: 
    0 0 16px rgba(0, 120, 215, 0.8),
    0 0 32px rgba(0, 120, 215, 0.4),
    0 0 48px rgba(0, 120, 215, 0.2);
  transform: scale(1.5);
  animation: selectedBadgeGlow 1.5s ease-in-out infinite;
}

@keyframes selectedBadgeGlow {
  0%, 100% {
    box-shadow: 
      0 0 16px rgba(0, 120, 215, 0.8),
      0 0 32px rgba(0, 120, 215, 0.4),
      0 0 48px rgba(0, 120, 215, 0.2);
  }
  50% {
    box-shadow: 
      0 0 20px rgba(0, 120, 215, 1),
      0 0 40px rgba(0, 120, 215, 0.6),
      0 0 60px rgba(0, 120, 215, 0.3);
  }
}

/* Enhanced styling for primary categories */
.blockly-category-primary .blocklyTreeRow {
  font-weight: 600 !important;
}

/* Enhanced styling for secondary categories */
.blockly-category-enhanced .blocklyTreeRow {
  opacity: 0.95;
  font-size: 15px !important;
}

.blockly-category-enhanced .blocklyTreeRow:hover {
  opacity: 1;
}

/* Basic icon - grid/app icon */
.blocklyTreeRow[style*="color: rgb(0, 120, 215)"] .blocklyTreeLabel::before,
.blockly-basic-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%230078D7'%3E%3Cpath d='M4 4h7v7H4V4m0 9h7v7H4v-7m9-9h7v7h-7V4m0 9h7v7h-7v-7z'/%3E%3C/svg%3E");
}

/* Input icon - game controller */
.blocklyTreeRow[style*="color: rgb(199, 36, 177)"] .blocklyTreeLabel::before,
.blockly-input-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23C724B1'%3E%3Cpath d='M7 6h10l-5.01 6.3L7 6zm-1.99 4.99L2 10l5.01 1 .99 3-3.01-.01zm11.98.01l-1-.01-1 3 5.01 1-3.01-4.01zm2-2.99L18 11l-5.01-1L12 7l7.01 3zM12 15c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z'/%3E%3C/svg%3E");
}

/* Music icon - musical note */
.blocklyTreeRow[style*="color: rgb(235, 68, 55)"] .blocklyTreeLabel::before,
.blockly-music-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23EB4437'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E");
}

/* Led icon - lightbulb */
.blocklyTreeRow[style*="color: rgb(106, 27, 154)"] .blocklyTreeLabel::before,
.blockly-led-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%236A1B9A'%3E%3Cpath d='M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 0 1 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z'/%3E%3C/svg%3E");
}

/* Radio icon - broadcast/signal */
.blocklyTreeRow[style*="color: rgb(233, 30, 99)"] .blocklyTreeLabel::before,
.blockly-radio-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23E91E63'%3E%3Cpath d='M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z'/%3E%3C/svg%3E");
}

/* Loops icon - refresh/repeat */
.blocklyTreeRow[style*="color: rgb(55, 171, 65)"] .blocklyTreeLabel::before,
.blockly-loops-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2337AB41'%3E%3Cpath d='M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46A7.93 7.93 0 0 0 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74A7.93 7.93 0 0 0 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z'/%3E%3C/svg%3E");
}

/* Logic icon - git branch/decision tree */
.blocklyTreeRow[style*="color: rgb(0, 188, 212)"] .blocklyTreeLabel::before,
.blockly-logic-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300BCD4'%3E%3Cpath d='M6 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 2.8-2H11v5h2V6h2.2a3 3 0 0 0 2.8 2 3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-2.8 2H13v2h-2V4H8.8A3 3 0 0 0 6 2m0 2a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m12 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-6 7a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 2a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1z'/%3E%3C/svg%3E");
}

/* Variables icon - list/document */
.blocklyTreeRow[style*="color: rgb(220, 53, 69)"] .blocklyTreeLabel::before,
.blockly-variables-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23DC3545'%3E%3Cpath d='M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m7 1.5V9h5.5L13 3.5zM8 11v2h8v-2H8m0 4v2h8v-2H8z'/%3E%3C/svg%3E");
}

/* Math icon - calculator */
.blocklyTreeRow[style*="color: rgb(123, 45, 143)"] .blocklyTreeLabel::before,
.blockly-math-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%237B2D8F'%3E%3Cpath d='M7 2h10a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 2v4h10V4H7m0 6v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2m-8 4v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2m-8 4v2h2v-2H7m4 0v2h2v-2h-2m4 0v2h2v-2h-2z'/%3E%3C/svg%3E");
}

/* Advanced icon - settings/gear */
.blocklyTreeRow[style*="color: rgb(92, 92, 92)"] .blocklyTreeLabel::before,
.blockly-advanced-icon .blocklyTreeLabel::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%235C5C5C'%3E%3Cpath d='M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z'/%3E%3C/svg%3E");
}

/* Premium toolbox container with glass morphism */
.blocklyToolboxDiv {
  background: linear-gradient(180deg, 
    rgba(255, 255, 255, 0.95) 0%, 
    rgba(250, 252, 255, 0.93) 20%,
    rgba(248, 250, 254, 0.93) 50%,
    rgba(245, 248, 252, 0.93) 80%,
    rgba(242, 246, 250, 0.95) 100%) !important;
  border-right: 2px solid rgba(0, 120, 215, 0.15) !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "SF Pro Display", Roboto, sans-serif !important;
  box-shadow: 
    4px 0 24px rgba(0, 0, 0, 0.08),
    8px 0 48px rgba(0, 0, 0, 0.04),
    inset -1px 0 0 rgba(255, 255, 255, 0.8) !important;
  backdrop-filter: blur(20px) saturate(180%) !important;
  -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
  padding: 0 !important;
  position: relative !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
}

/* Animated gradient header for toolbox */
.blocklyToolboxDiv::before {
  content: "";
  position: sticky;
  top: 0;
  left: 0;
  right: 0;
  height: 6px;
  background: linear-gradient(90deg, 
    #0078D7 0%, 
    #00BCD4 25%, 
    #6A1B9A 50%, 
    #C724B1 75%,
    #EB4437 100%);
  background-size: 200% 100%;
  animation: headerGradientFlow 8s ease infinite;
  opacity: 0.85;
  z-index: 100;
  display: block;
  box-shadow: 0 4px 12px rgba(0, 120, 215, 0.2);
}

@keyframes headerGradientFlow {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Add padding container after header */
.blocklyToolboxDiv > div:first-of-type {
  padding-top: 20px !important;
}

/* Premium scrollbar design */
.blocklyToolboxDiv::-webkit-scrollbar {
  width: 10px;
}

.blocklyToolboxDiv::-webkit-scrollbar-track {
  background: linear-gradient(180deg, 
    rgba(241, 245, 249, 0.3) 0%,
    rgba(241, 245, 249, 0.5) 50%,
    rgba(241, 245, 249, 0.3) 100%);
  border-radius: 10px;
  margin: 8px 0;
}

.blocklyToolboxDiv::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, 
    rgba(0, 120, 215, 0.4) 0%,
    rgba(0, 120, 215, 0.6) 50%,
    rgba(0, 120, 215, 0.4) 100%);
  border-radius: 10px;
  border: 2px solid rgba(255, 255, 255, 0.5);
  transition: all 0.3s ease;
}

.blocklyToolboxDiv::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, 
    rgba(0, 120, 215, 0.7) 0%,
    rgba(0, 120, 215, 0.9) 50%,
    rgba(0, 120, 215, 0.7) 100%);
  border-color: rgba(255, 255, 255, 0.7);
  box-shadow: 0 0 12px rgba(0, 120, 215, 0.4);
}

/* Search box styling */
.blocklySearchBox {
  padding: 12px !important;
  background: white !important;
  border-bottom: 1px solid #ddd !important;
}

.blocklySearchBox input {
  width: 100% !important;
  padding: 8px 12px !important;
  border: 1px solid #ccc !important;
  border-radius: 4px !important;
  font-size: 14px !important;
}

/* Blockly flyout (block preview area) styling with glassmorphism */
.blocklyFlyout {
  border-radius: 16px 0 0 16px !important;
  box-shadow: -4px 0 24px rgba(0, 0, 0, 0.12) !important;
  background: rgba(255, 255, 255, 0.95) !important;
  backdrop-filter: blur(20px) !important;
  -webkit-backdrop-filter: blur(20px) !important;
}

.blocklyFlyoutBackground {
  fill: rgba(255, 255, 255, 0.95) !important;
  fill-opacity: 1 !important;
}

/* Add visual separation between block groups in flyout */
.blocklyFlyout .blocklyBlockCanvas > g[transform] + g[transform] {
  margin-top: 8px;
}

/* Enhance blocks in flyout with better spacing */
.blocklyFlyout .blocklyDraggable {
  margin: 6px 0 !important;
}

/* Add labels/headers for block categories in flyout */
.blocklyFlyoutLabel {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
  font-size: 14px !important;
  font-weight: 600 !important;
  fill: #666 !important;
}

/* Style the flyout scrollbar */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #ccc !important;
  rx: 4 !important;
}

.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #999 !important;
}

.blocklyFlyout .blocklyScrollbarBackground {
  fill: #f9f9f9 !important;
  stroke: none !important;
}

/* Add icon decoration to specific blocks in flyout */
/* This uses data attributes that can be added to blocks */
[data-block-icon]::before {
  content: attr(data-block-icon);
  display: inline-block;
  margin-right: 8px;
  font-size: 18px;
}

/* Enhanced visual hierarchy in flyout */
.blocklyFlyout .blocklyBlockCanvas {
  padding: 12px 8px !important;
}

/* Add subtle hover effect on blocks in flyout */
.blocklyFlyout .blocklyDraggable:hover {
  transform: translateX(-2px);
  transition: transform 0.15s ease;
}

/* Style buttons in flyout (like "Make a Variable") */
.blocklyFlyout .blocklyFlyoutButton {
  fill: #fff !important;
  stroke: #ddd !important;
  stroke-width: 1px !important;
  rx: 6 !important;
  ry: 6 !important;
}

.blocklyFlyout .blocklyFlyoutButton:hover {
  fill: #f0f0f0 !important;
  stroke: #0078D7 !important;
  stroke-width: 2px !important;
}

.blocklyFlyout .blocklyFlyoutButtonBackground {
  fill: #fff !important;
  stroke: #ddd !important;
}

.blocklyFlyout .blocklyText.blocklyFlyoutLabelText {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
  font-weight: 500 !important;
  fill: #333 !important;
}

/* Improve block field styling — minimal, performant */
.blocklyEditableText {
  fill: #1f2937 !important; /* gray-800 */
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji" !important;
}

.blocklyEditableText rect {
  fill: #ffffff !important;
  stroke: #cbd5e1 !important; /* slate-300 */
}

/* Dropdown fields styling — reduced shadow, faster paint */
.blocklyDropDownDiv {
  border-radius: 8px !important;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08) !important;
  border: 1px solid #e5e7eb !important; /* gray-200 */
  background-color: #ffffff !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial !important;
}

.blocklyDropDownDiv .goog-menuitem {
  padding: 8px 12px !important;
  font-size: 13px !important;
}

.blocklyDropDownDiv .goog-menuitem-highlight {
  background-color: #eff6ff !important; /* blue-50 */
  color: #1d4ed8 !important; /* blue-700 */
}

/* Input fields in blocks — clean, compact */
.blocklyHtmlInput {
  /* Match toolbox label font to minimize glyph mismatch with SVG */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji" !important;
  border: 1px solid #e5e7eb !important; /* gray-200 */
  border-radius: 6px !important;
  padding: 4px 6px !important;
  background: #ffffff !important;
  color: #111827 !important; /* gray-900 */
  text-shadow: none !important;
  outline: none !important;
}

.blocklyHtmlInput:focus {
  border-color: #93c5fd !important; /* blue-300 */
  box-shadow: 0 0 0 3px rgba(147, 197, 253, 0.35) !important;
}

/* Remove text shadow from editable SVG text fields to avoid glow while editing */
.blocklyEditableText,
.blocklyEditableText .blocklyText {
  text-shadow: none !important;
}

/* Context menu styling */
.blocklyContextMenu {
  border-radius: 8px !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
  border: 1px solid #ddd !important;
}

.blocklyMenuItem {
  padding: 8px 16px !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
  font-size: 14px !important;
}

.blocklyMenuItemHighlight {
  background-color: #e3f2fd !important;
}

.blocklyMenuItemContent {
  color: #333 !important;
}


/* Blockly workspace background with modern gradient */
.blocklyMainBackground {
  stroke: none !important;
  fill: url(#blockly-workspace-gradient) !important;
}

/* Create gradient pattern for workspace */
.blocklyWorkspace {
  background: linear-gradient(135deg, #e8eef3 0%, #d3dae2 100%) !important;
}

/* Enhanced block shadows with smooth animations */
.blocklyBlockCanvas .blocklyDraggable {
  filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.15));
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.blocklyBlockCanvas .blocklyDraggable:hover {
  filter: drop-shadow(0 6px 16px rgba(0, 0, 0, 0.25));
  transform: translateY(-2px);
}

.blocklyBlockCanvas .blocklyDraggable:active {
  filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.3));
  transform: scale(1.02);
}

/* blockly fix */
svg[display="none"] {
  display: none;
}

/* Category-specific flyout header styling with icons */
.blocklyFlyout .blocklyFlyoutLabelText {
  font-size: 16px !important;
  font-weight: 600 !important;
  fill: #333 !important;
}

/* Add visual indicators for block types */
/* Basic blocks - show grid icon */
.blocklyFlyout g[data-category="Basic"] .blocklyPath,
g.blocklyDraggable[data-id*="show_string"] .blocklyPath,
g.blocklyDraggable[data-id*="show_number"] .blocklyPath,
g.blocklyDraggable[data-id*="on_start"] .blocklyPath {
  filter: brightness(1.05);
}

/* Input blocks - add subtle glow */
g.blocklyDraggable[data-id*="button"] .blocklyPath,
g.blocklyDraggable[data-id*="input"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(199, 36, 177, 0.3));
}

/* LED blocks - add glow effect */
g.blocklyDraggable[data-id*="led"] .blocklyPath,
g.blocklyDraggable[data-id*="plot"] .blocklyPath,
g.blocklyDraggable[data-id*="show_leds"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(106, 27, 154, 0.3));
}

/* Loop blocks - add rotation hint */
g.blocklyDraggable[data-id*="forever"] .blocklyPath,
g.blocklyDraggable[data-id*="while"] .blocklyPath,
g.blocklyDraggable[data-id*="for"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(55, 171, 65, 0.3));
}

/* Logic blocks - add branch indicator */
g.blocklyDraggable[data-id*="if"] .blocklyPath,
g.blocklyDraggable[data-id*="logic"] .blocklyPath {
  filter: drop-shadow(0 0 2px rgba(0, 188, 212, 0.3));
}

/* Enhanced block spacing in flyout */
.blocklyFlyout .blocklyBlockCanvas > g {
  margin-bottom: 12px;
}

/* Add separator lines between block groups with modern styling */
.blocklyFlyout .blocklyFlyoutButton + g,
.blocklyFlyout text.blocklyText[text-anchor="start"] + g {
  margin-top: 20px !important;
  position: relative;
}

/* Add subtle divider line effect */
.blocklyFlyout .blocklyFlyoutButton + g::before,
.blocklyFlyout text.blocklyText[text-anchor="start"] + g::before {
  content: "";
  position: absolute;
  top: -10px;
  left: 8px;
  right: 8px;
  height: 2px;
  background: linear-gradient(90deg, transparent, rgba(200, 200, 200, 0.3), transparent);
  border-radius: 1px;
}

/* Better visual feedback for dragging from flyout */
.blocklyDragging {
  opacity: 0.85 !important;
  filter: drop-shadow(0 8px 28px rgba(0, 0, 0, 0.35)) brightness(1.05) !important;
  transform: scale(1.05) !important;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

/* Improve block corner radius and modern styling */
.blocklyPath {
  stroke-width: 1.5px !important;
  stroke-opacity: 0.25 !important;
  transition: all 0.2s ease !important;
}

/* Add subtle glow effect on block hover */
.blocklyWorkspace .blocklyDraggable:hover .blocklyPath {
  filter: brightness(1.12) drop-shadow(0 6px 12px rgba(0, 0, 0, 0.25)) !important;
  stroke-opacity: 0.35 !important;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

/* Active block gets stronger glow */
.blocklyWorkspace .blocklySelected .blocklyPath {
  filter: brightness(1.15) drop-shadow(0 0 12px currentColor) !important;
  stroke-width: 2px !important;
  stroke-opacity: 0.5 !important;
}

/* Improve connection highlights */
.blocklyConnectionCircle {
  fill: #fff !important;
  stroke: currentColor !important;
  stroke-width: 2px !important;
}

.blocklyReplaceable .blocklyPath {
  stroke: #ffa500 !important;
  stroke-width: 3px !important;
  fill-opacity: 0.9 !important;
}

/* Enhanced insertion marker */
.blocklyInsertionMarker .blocklyPath {
  fill-opacity: 0.3 !important;
  stroke: #333 !important;
  stroke-width: 2px !important;
  stroke-dasharray: 4, 4 !important;
}

/* Improve trash can styling with modern animations */
.blocklyTrash {
  opacity: 0.75;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.15));
}

.blocklyTrash:hover {
  opacity: 1;
  transform: scale(1.1);
  filter: drop-shadow(0 4px 12px rgba(220, 38, 38, 0.4));
}

/* Better zoom controls with modern glass effect */
.blocklyZoom {
  opacity: 0.8;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  backdrop-filter: blur(8px);
  background: rgba(255, 255, 255, 0.9) !important;
  border-radius: 12px !important;
  padding: 4px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
}

.blocklyZoom:hover {
  opacity: 1;
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
}

.blocklyZoom > image {
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15));
  transition: all 0.2s ease;
}

.blocklyZoom > image:hover {
  filter: drop-shadow(0 3px 8px rgba(99, 102, 241, 0.4));
}

/* Workspace Grid: color and refine the entire grid */
/* Targets the SVG pattern used by Blockly for background grid */
.blocklyGridPattern line {
  stroke: rgba(0, 120, 215, 0.18) !important; /* soft blue lines */
  stroke-width: 1 !important;
  shape-rendering: crispEdges !important;
}

.blocklyGridPattern path {
  stroke: rgba(0, 120, 215, 0.12) !important; /* minor grid subdivisions */
  stroke-width: 0.5 !important;
  shape-rendering: crispEdges !important;
}

.blocklyGridPattern rect,
.blocklyGridPattern .blocklyGridRect,
.blocklyGridPattern .blocklyGridDot {
  fill: rgba(0, 120, 215, 0.22) !important; /* dot-based grids */
}

/* Slightly increase grid contrast when dragging for better alignment */
.blocklyDragging ~ svg defs .blocklyGridPattern line,
.blocklyDragging ~ svg defs .blocklyGridPattern path,
.blocklyDragging ~ svg defs .blocklyGridPattern rect {
  stroke: rgba(0, 120, 215, 0.28) !important;
  fill: rgba(0, 120, 215, 0.3) !important;
}
